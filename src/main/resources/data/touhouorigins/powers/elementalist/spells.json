{
  "type": "apoli:multiple",

  "magifire_apply": {
    "type":"apoli:target_action_on_hit",
    "damage_condition": {
      "type": "apoli:projectile",
      "projectile": "minecraft:fireball"
    },
    "entity_action": {
      "type": "apoli:apply_effect",
      "effect": {
        "effect": "touhouorigins:magifire",
        "duration": 10,
        "show_particles": false,
        "show_icon": false
      }
    }
  },

  "fireball_spawn": {
    "type": "apoli:fire_projectile",
    "entity_type": "minecraft:fireball",
    "cooldown": 10,
    "speed": 0.5,
    "divergence": 0,
    "hud_render": {
      "should_render": false
    },
    "key": {
      "key": "key.origins.primary_active"
    },
    "tag": "{ExplosionPower:0}",
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/mana_resource",
          "comparison": ">=",
          "compare_to": 60
        },
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/spellcycle_counter",
          "comparison": "==",
          "compare_to": 0
        }
      ]
    }
  },
  "fireball": {
    "type": "apoli:active_self",
    "entity_action": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:delay",
          "ticks": 1,
          "action": {
            "type": "apoli:change_resource",
            "resource": "touhouorigins:elementalist/mana_resource",
            "change": -60
          }
        },
        {
          "type": "apoli:play_sound",
          "sound": "minecraft:block.enchantment_table.use",
          "pitch": 1.5
        },
        {
          "type": "apoli:play_sound",
          "sound": "minecraft:entity.ghast.shoot",
          "pitch": 0.5
        },
        {
          "type": "apoli:execute_command",
          "command": "particle minecraft:lava ~ ~1 ~ 0.1 0.1 0.1 1 25"
        }
      ]
    },
    "cooldown": 10,
    "key": {
      "key": "key.origins.primary_active"
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/mana_resource",
          "comparison": ">=",
          "compare_to": 60
        },
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/spellcycle_counter",
          "comparison": "==",
          "compare_to": 0
        }
      ]
    }
  },
  "fireball_explode":{
    "type": "apoli:action_on_hit",
    "bientity_action":{
      "type": "apoli:target_action",
      "action": {
        "type": "apoli:chance",
        "action": {
          "type": "and",
          "actions": [
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:flame"
              },
              "count": 200,
              "speed": 0,
              "spread": {
                "x": 0.5,
                "y": 3,
                "z": 0.5
              },
              "offset_y": 1.5
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:flame"
              },
              "count": 100,
              "speed": 0,
              "spread": {
                "x": 0.25,
                "y": 3,
                "z": 0.25
              },
              "offset_y": 3
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:flame"
              },
              "count": 100,
              "speed": 0,
              "spread": {
                "x": 0.1,
                "y": 4,
                "z": 0.1
              },
              "offset_y": 5
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:flame"
              },
              "count": 100,
              "speed": 0.2,
              "spread": {
                "x": 2,
                "y": 0,
                "z": 2
              },
              "offset_y": 0
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:flame"
              },
              "count": 200,
              "speed": 0.01,
              "spread": {
                "x": 1,
                "y": 1,
                "z": 1
              },
              "offset_y": -1
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:lava"
              },
              "count": 50,
              "speed": 0.01,
              "spread": {
                "x": 1,
                "y": 0,
                "z": 1
              },
              "offset_y": 1
            },
            {
              "type": "apoli:spawn_particles",
              "particle": {
                "type": "minecraft:lava"
              },
              "count": 20,
              "speed": 0.01,
              "spread": {
                "x": 1,
                "y": 5,
                "z": 1
              },
              "offset_y": 2.5
            },
            {
              "type": "apoli:area_of_effect",
              "radius": 6,
              "bientity_action": {
                "type": "apoli:target_action",
                "action": {
                  "type": "apoli:and",
                  "actions": [
                    {
                      "type": "apoli:set_on_fire",
                      "duration": 5
                    },
                    {
                      "type": "apoli:damage",
                      "amount": 8,
                      "source": {
                        "name": "onFire",
                        "fire": "true",
                        "bypasses_armor": true
                      }
                    },
                    {
                      "type": "apoli:apply_effect",
                      "effect": {
                        "effect": "touhouorigins:magifire",
                        "duration": 10,
                        "show_particles": false,
                        "show_icon": false
                      }
                    },
                    {
                      "type": "apoli:clear_effect",
                      "effect": "touhouorigins:magiwood"
                    },
                    {
                      "type": "apoli:clear_effect",
                      "effect": "touhouorigins:magimetal"
                    }
                  ]
                }
              }
            }
          ]
        },
        "chance": 1
      }
    },
    "damage_condition": {
      "type": "apoli:projectile",
      "projectile": "minecraft:fireball"
    },
    "bientity_condition": {
      "type": "apoli:target_condition",
      "condition": {
        "type": "apoli:status_effect",
        "effect": "touhouorigins:magiwood"
      }
    },
    "cooldown": 5
  },

  "heal": {
    "type": "apoli:active_self",
    "entity_action": {
      "type": "apoli:and",
      "actions": [
        {
          "type": "apoli:change_resource",
          "resource": "touhouorigins:elementalist/mana_resource",
          "change": -65
        },
        {
          "type": "apoli:heal",
          "amount": 4
        },
        {
          "type": "apoli:extinguish"
        },
        {
          "type": "apoli:play_sound",
          "sound": "minecraft:block.conduit.activate",
          "pitch": 2
        },
        {
          "type": "apoli:play_sound",
          "sound": "minecraft:block.conduit.ambient.short"
        },
        {
          "type": "apoli:execute_command",
          "command": "particle minecraft:dust 0 1 0.5 1 ~ ~1 ~ 0.5 0.5 0.5 1 100"
        },
        {
          "type": "apoli:execute_command",
          "command": "particle minecraft:block minecraft:lily_pad ~ ~1 ~ 0.5 0.5 0.5 1 100"
        },
        {
          "type": "apoli:execute_command",
          "command": "particle minecraft:bubble_pop ~ ~1 ~ 0.5 0.5 0.5 0.10 100"
        },
        {
          "type": "apoli:execute_command",
          "command": "particle minecraft:rain ~ ~1 ~ 0.5 0.5 0.5 1 100"
        }
      ]
    },
    "cooldown": 10,
    "key": {
      "key": "key.origins.primary_active"
    },
    "condition": {
      "type": "apoli:and",
      "conditions": [
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/mana_resource",
          "comparison": ">=",
          "compare_to": 65
        },
        {
          "type": "apoli:resource",
          "resource": "touhouorigins:elementalist/spellcycle_counter",
          "comparison": "==",
          "compare_to": 1
        }
      ]
    }
  }
}